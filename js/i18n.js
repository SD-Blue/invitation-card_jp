// H·ªá th·ªëng ƒëa ng√¥n ng·ªØ cho thi·ªáp c∆∞·ªõi
const translations = {
  vi: {
    // Meta
    title: "ƒê√°m c∆∞·ªõi S·ªπ & Dung",
    description: "Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi ƒë√°m c∆∞·ªõi c·ªßa VƒÉn S·ªπ & Th√πy Dung",

    // Main header
    header_getting_married: "| CH√öNG T√îI S·∫ÆP K·∫æT H√îN |",
    header_date_time: "2026. 01. 17. TH·ª® 7 11:00 AM",
    header_location: "PH√ö VINH - TP HU·∫æ",

    // Navigation
    nav_home: "Trang ch·ªß",
    nav_couple: "C√¥ d√¢u & Ch√∫ r·ªÉ",
    nav_events: "S·ª± ki·ªán",
    nav_gallery: "Th∆∞ vi·ªán ·∫£nh",

    // Couple section
    couple_subtitle: "M·ªôt h√†nh tr√¨nh m·ªõi b·∫Øt ƒë·∫ßu t·ª´ h√¥m nay",
    bride_family: "NH√Ä G√ÅI:",
    groom_family: "NH√Ä TRAI:",
    mr: "√îNG:",
    mrs: "B√Ä:",

    // Events section
    events_title: "Th∆∞ m·ªùi",
    events_subtitle: "Tham d·ª± l·ªÖ c∆∞·ªõi c·ªßa S·ªπ v√† Dung",
    event_groom_reception: "TI·ªÜC C∆Ø·ªöI NH√Ä TRAI",
    event_bride_reception: "TI·ªÜC C∆Ø·ªöI NH√Ä G√ÅI",
    event_wedding_ceremony: "L·ªÑ TH√ÄNH H√îN",
    event_vu_quy: "L·ªÑ VU QUY",
    ceremony_will_start: "H√¥n l·ªÖ s·∫Ω di·ªÖn ra sau:",

    // Days of week
    monday: "Th·ª© Hai",
    tuesday: "Th·ª© Ba",
    wednesday: "Th·ª© T∆∞",
    thursday: "Th·ª© NƒÉm",
    friday: "Th·ª© S√°u",
    saturday: "Th·ª© B·∫£y",
    sunday: "Ch·ªß Nh·∫≠t",
    thu_bay: "Th·ª© B·∫£y",
    thu_tu: "Th·ª© T∆∞",
    thu_7: "Th·ª© 7",
    thu_4: "Th·ª© 4",

    // Date format
    month: "Th√°ng",
    month_1: "Th√°ng 1",
    lunar_date_29: "(T·ª©c ng√†y 29, th√°ng 11, nƒÉm ·∫§t T·ªµ)",
    lunar_date_26: "(T·ª©c ng√†y 26, th√°ng 11, nƒÉm ·∫§t T·ªµ)",

    // Countdown
    days: "Ng√†y",
    hours: "Gi·ªù",
    minutes: "Ph√∫t",
    seconds: "Gi√¢y",

    // Location
    location_title: "üó∫Ô∏è ƒê·ªãa ƒëi·ªÉm t·ªï ch·ª©c",
    location_groom: "NH√Ä TRAI",
    location_bride: "NH√Ä G√ÅI",
    view_directions: "XEM CH·ªà ƒê∆Ø·ªúNG",

    // Gallery
    gallery_title: "Love Story",

    // Love quotes
    quote_1: '"T√¨nh y√™u kh√¥ng l√†m cho th·∫ø gi·ªõi quay tr√≤n. T√¨nh y√™u l√† th·ª© l√†m cho chuy·∫øn ƒëi ƒë√°ng gi√°."',
    quote_2: '"ƒê∆∞·ª£c ai ƒë√≥ y√™u s√¢u ƒë·∫≠m s·∫Ω mang l·∫°i cho b·∫°n s·ª©c m·∫°nh, trong khi y√™u ai ƒë√≥ s√¢u ƒë·∫≠m s·∫Ω cho b·∫°n can ƒë·∫£m."',
    quote_3: '"T√¨nh y√™u ch√¢n th√†nh nh·∫•t l√† t√¨nh y√™u kh√¥ng ƒëi·ªÅu ki·ªán, kh√¥ng ƒë√≤i h·ªèi, ch·ªâ cho ƒëi."',
    quote_4: '"Trong t·∫•t c·∫£ nh·ªØng g√¨ tr√°i tim t√¥i y√™u th∆∞∆°ng, em lu√¥n l√† ƒëi·ªÅu tuy·ªát v·ªùi nh·∫•t."',

    // Gift section
    gift_title: "Qu√† m·ª´ng ƒë√°m c∆∞·ªõi",
    gift_bank: "Bank: @Th√πy-Dung"
  },

  ja: {
    // Meta
    title: "„Ç∑„ÉºÔºÜ„Ç∫„É≥„ÅÆÁµêÂ©öÂºè",
    description: "„É¥„Ç°„É≥„Éª„Ç∑„Éº„Å®„Éà„Ç•„Ç§„Éª„Ç∫„É≥„ÅÆÁµêÂ©öÂºè„Å∏„Çà„ÅÜ„Åì„Åù",

    // Main header
    header_getting_married: "| ÁµêÂ©ö„Åó„Åæ„Åô |",
    header_date_time: "2026. 01. 17. ÂúüÊõúÊó• 11:00 AM",
    header_location: "„Éï„Éº„É¥„Ç£„É≥ - „Éï„Ç®Â∏Ç",

    // Navigation
    nav_home: "„Éõ„Éº„É†",
    nav_couple: "Êñ∞ÈÉéÊñ∞Â©¶",
    nav_events: "„Ç§„Éô„É≥„Éà",
    nav_gallery: "„Éï„Ç©„Éà„ÇÆ„É£„É©„É™„Éº",

    // Couple section
    couple_subtitle: "‰ªäÊó•„Åã„ÇâÊñ∞„Åó„ÅÑÊóÖ„ÅåÂßã„Åæ„Çä„Åæ„Åô",
    bride_family: "Êñ∞Â©¶ÂÅ¥:",
    groom_family: "Êñ∞ÈÉéÂÅ¥:",
    mr: "Áà∂:",
    mrs: "ÊØç:",

    // Events section
    events_title: "ÊãõÂæÖÁä∂",
    events_subtitle: "„Ç∑„Éº„Å®„Ç∫„É≥„ÅÆÁµêÂ©öÂºè„Å´„ÅîÂèÇÂä†„Åè„Å†„Åï„ÅÑ",
    event_groom_reception: "Êñ∞ÈÉéÂÅ¥Êä´Èú≤ÂÆ¥",
    event_bride_reception: "Êñ∞Â©¶ÂÅ¥Êä´Èú≤ÂÆ¥",
    event_wedding_ceremony: "ÁµêÂ©öÂºè",
    event_vu_quy: "„É¥„Éº„ÇØ„Ç§„ÅÆÂÑÄÂºè",
    ceremony_will_start: "Âºè„Åæ„Åß:",

    // Days of week
    monday: "ÊúàÊõúÊó•",
    tuesday: "ÁÅ´ÊõúÊó•",
    wednesday: "Ê∞¥ÊõúÊó•",
    thursday: "Êú®ÊõúÊó•",
    friday: "ÈáëÊõúÊó•",
    saturday: "ÂúüÊõúÊó•",
    sunday: "Êó•ÊõúÊó•",
    thu_bay: "ÂúüÊõúÊó•",
    thu_tu: "Ê∞¥ÊõúÊó•",
    thu_7: "ÂúüÊõúÊó•",
    thu_4: "Ê∞¥ÊõúÊó•",

    // Date format
    month: "Êúà",
    month_1: "1Êúà",
    lunar_date_29: "(ÊóßÊö¶ 11Êúà29Êó•„ÄÅ‰πôÂ∑≥Âπ¥)",
    lunar_date_26: "(ÊóßÊö¶ 11Êúà26Êó•„ÄÅ‰πôÂ∑≥Âπ¥)",

    // Countdown
    days: "Êó•",
    hours: "ÊôÇÈñì",
    minutes: "ÂàÜ",
    seconds: "Áßí",

    // Location
    location_title: "üó∫Ô∏è ‰ºöÂ†¥",
    location_groom: "Êñ∞ÈÉéÂÅ¥",
    location_bride: "Êñ∞Â©¶ÂÅ¥",
    view_directions: "ÈÅìÈ†Ü„ÇíË¶ã„Çã",

    // Gallery
    gallery_title: "„É©„Éñ„Çπ„Éà„Éº„É™„Éº",

    // Love quotes
    quote_1: '"ÊÑõ„ÅØ‰∏ñÁïå„ÇíÂõûËª¢„Åï„Åõ„Çã„ÇÇ„ÅÆ„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇÊÑõ„ÅØÊóÖ„Çí‰æ°ÂÄ§„ÅÇ„Çã„ÇÇ„ÅÆ„Å´„Åô„Çã„ÇÇ„ÅÆ„Åß„Åô„ÄÇ"',
    quote_2: '"Ë™∞„Åã„Å´Ê∑±„ÅèÊÑõ„Åï„Çå„Çã„Åì„Å®„ÅØÂäõ„Çí‰∏é„Åà„ÄÅË™∞„Åã„ÇíÊ∑±„ÅèÊÑõ„Åô„Çã„Åì„Å®„ÅØÂãáÊ∞ó„Çí‰∏é„Åà„Åæ„Åô„ÄÇ"',
    quote_3: '"ÊúÄ„ÇÇÁúüÂÆü„Å™ÊÑõ„ÅØ„ÄÅÊù°‰ª∂„Å™„Åè„ÄÅË¶ÅÊ±Ç„Åõ„Åö„ÄÅ„Åü„Å†‰∏é„Åà„ÇãÊÑõ„Åß„Åô„ÄÇ"',
    quote_4: '"ÁßÅ„ÅÆÂøÉ„ÅåÊÑõ„Åô„Çã„Åô„Åπ„Å¶„ÅÆ„ÇÇ„ÅÆ„ÅÆ‰∏≠„Åß„ÄÅ„ÅÇ„Å™„Åü„ÅØÂ∏∏„Å´ÊúÄ„ÇÇÁ¥†Êô¥„Çâ„Åó„ÅÑ„ÇÇ„ÅÆ„Åß„Åô„ÄÇ"',

    // Gift section
    gift_title: "„ÅäÁ•ù„ÅÑ",
    gift_bank: "ÈäÄË°å: @Th√πy-Dung"
  }
};

// Ng√¥n ng·ªØ hi·ªán t·∫°i
let currentLang = 'vi';

// Ph√°t hi·ªán ng√¥n ng·ªØ d·ª±a tr√™n v·ªã tr√≠ ƒë·ªãa l√Ω
async function detectLanguageByLocation() {
  try {
    // L·∫•y th√¥ng tin v·ªã tr√≠ t·ª´ IP
    const response = await fetch('https://ipapi.co/json/');
    const data = await response.json();

    // N·∫øu ·ªü Nh·∫≠t B·∫£n, d√πng ti·∫øng Nh·∫≠t
    if (data.country_code === 'JP') {
      return 'ja';
    }

    // M·∫∑c ƒë·ªãnh ti·∫øng Vi·ªát
    return 'vi';
  } catch (error) {
    console.log('Kh√¥ng th·ªÉ ph√°t hi·ªán v·ªã tr√≠, s·ª≠ d·ª•ng ng√¥n ng·ªØ m·∫∑c ƒë·ªãnh');

    // Fallback: ki·ªÉm tra ng√¥n ng·ªØ tr√¨nh duy·ªát
    const browserLang = navigator.language || navigator.userLanguage;
    if (browserLang.startsWith('ja')) {
      return 'ja';
    }

    return 'vi';
  }
}

// L·∫•y ng√¥n ng·ªØ ƒë√£ l∆∞u ho·∫∑c ph√°t hi·ªán t·ª± ƒë·ªông
async function getLanguage() {
  // Ki·ªÉm tra localStorage
  const savedLang = localStorage.getItem('wedding_language');
  if (savedLang) {
    return savedLang;
  }

  // Ph√°t hi·ªán t·ª± ƒë·ªông
  const detectedLang = await detectLanguageByLocation();
  localStorage.setItem('wedding_language', detectedLang);
  return detectedLang;
}

// √Åp d·ª•ng ng√¥n ng·ªØ cho trang
function applyLanguage(lang) {
  currentLang = lang;

  // C·∫≠p nh·∫≠t meta tags
  document.title = translations[lang].title;
  document.querySelector('meta[name="description"]').setAttribute('content', translations[lang].description);
  document.querySelector('html').setAttribute('lang', lang === 'ja' ? 'ja' : 'vi');

  // C·∫≠p nh·∫≠t t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c√≥ data-i18n
  document.querySelectorAll('[data-i18n]').forEach(element => {
    const key = element.getAttribute('data-i18n');
    if (translations[lang][key]) {
      element.textContent = translations[lang][key];
    }
  });

  // L∆∞u l·ª±a ch·ªçn
  localStorage.setItem('wedding_language', lang);

  // C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t chuy·ªÉn ƒë·ªïi
  updateLanguageToggle();
}

// Chuy·ªÉn ƒë·ªïi ng√¥n ng·ªØ
function toggleLanguage() {
  const newLang = currentLang === 'vi' ? 'ja' : 'vi';
  applyLanguage(newLang);
}

// C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t chuy·ªÉn ƒë·ªïi
function updateLanguageToggle() {
  const toggle = document.getElementById('language-toggle');
  if (toggle) {
    toggle.textContent = currentLang === 'vi' ? 'Êó•Êú¨Ë™û' : 'Ti·∫øng Vi·ªát';
    toggle.title = currentLang === 'vi' ? 'Switch to Japanese' : 'Chuy·ªÉn sang Ti·∫øng Vi·ªát';
  }
}

// Kh·ªüi t·∫°o khi trang load
async function initLanguage() {
  const lang = await getLanguage();
  applyLanguage(lang);
}

// T·ª± ƒë·ªông kh·ªüi t·∫°o khi DOM ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initLanguage);
} else {
  initLanguage();
}
